{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/semiloreoshiyoye/Desktop/unibuddy/app/api/calendar/route.ts"],"sourcesContent":["export const runtime = \"nodejs\";\n\nimport { NextRequest, NextResponse } from \"next/server\";\n\nfunction toICSDate(dateStr: string) {\n  const [y, m, d] = dateStr.split(\"-\").map(Number);\n  if (!y || !m || !d) return null;\n  return `${y}${String(m).padStart(2, \"0\")}${String(d).padStart(2, \"0\")}T090000`;\n}\n\nfunction generateICS(tasks: any[]) {\n  const events = tasks\n    .map((t) => {\n      const dt = toICSDate(t.date);\n      if (!dt) return \"\";\n      const summary = `${t.course || \"Course\"}: ${t.title || \"Task\"} (P${t.priority ?? \"\"})`;\n      const desc = (t.notes || \"\").replace(/\\n/g, \"\\\\n\");\n\n      return `BEGIN:VEVENT\nDTSTART:${dt}\nSUMMARY:${summary}\nDESCRIPTION:${desc}\nEND:VEVENT`;\n    })\n    .filter(Boolean)\n    .join(\"\\n\");\n\n  return `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Unibuddy//AI Calendar//EN\n${events}\nEND:VCALENDAR`;\n}\n\nexport async function POST(req: NextRequest) {\n  try {\n    const { tasks } = await req.json();\n\n    if (!Array.isArray(tasks)) {\n      return NextResponse.json({ error: \"tasks must be an array\" }, { status: 400 });\n    }\n\n    const ics = generateICS(tasks);\n\n    return new NextResponse(ics, {\n      headers: {\n        \"Content-Type\": \"text/calendar\",\n        \"Content-Disposition\": 'attachment; filename=\"unibuddy-calendar.ics\"',\n      },\n    });\n  } catch (error: any) {\n    return NextResponse.json({ error: error.message || \"Calendar error\" }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;;;AAEA;AAFO,MAAM,UAAU;;AAIvB,SAAS,UAAU,OAAe;IAChC,MAAM,CAAC,GAAG,GAAG,EAAE,GAAG,QAAQ,KAAK,CAAC,KAAK,GAAG,CAAC;IACzC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,OAAO;IAC3B,OAAO,GAAG,IAAI,OAAO,GAAG,QAAQ,CAAC,GAAG,OAAO,OAAO,GAAG,QAAQ,CAAC,GAAG,KAAK,OAAO,CAAC;AAChF;AAEA,SAAS,YAAY,KAAY;IAC/B,MAAM,SAAS,MACZ,GAAG,CAAC,CAAC;QACJ,MAAM,KAAK,UAAU,EAAE,IAAI;QAC3B,IAAI,CAAC,IAAI,OAAO;QAChB,MAAM,UAAU,GAAG,EAAE,MAAM,IAAI,SAAS,EAAE,EAAE,EAAE,KAAK,IAAI,OAAO,GAAG,EAAE,EAAE,QAAQ,IAAI,GAAG,CAAC,CAAC;QACtF,MAAM,OAAO,CAAC,EAAE,KAAK,IAAI,EAAE,EAAE,OAAO,CAAC,OAAO;QAE5C,OAAO,CAAC;QACN,EAAE,GAAG;QACL,EAAE,QAAQ;YACN,EAAE,KAAK;UACT,CAAC;IACP,GACC,MAAM,CAAC,SACP,IAAI,CAAC;IAER,OAAO,CAAC;;;AAGV,EAAE,OAAO;aACI,CAAC;AACd;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,IAAI,IAAI;QAEhC,IAAI,CAAC,MAAM,OAAO,CAAC,QAAQ;YACzB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAC9E;QAEA,MAAM,MAAM,YAAY;QAExB,OAAO,IAAI,gJAAY,CAAC,KAAK;YAC3B,SAAS;gBACP,gBAAgB;gBAChB,uBAAuB;YACzB;QACF;IACF,EAAE,OAAO,OAAY;QACnB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO,IAAI;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACvF;AACF"}}]
}